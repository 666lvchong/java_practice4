<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.4//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="wechat_business.entity.ActivityRelation">
    <!-- 定义结果集 -->
    <resultMap id="activityRelationMap" type="wechat_business.entity.ActivityRelation">
        <id property="id" column="ID" jdbcType="BIGINT"/>
        <result property="activityInfoId" column="ACTIVITY_INFO_ID" jdbcType="BIGINT"/>
        <!-- 与商品是一对多关系 collection中的column是ActivityRelation表中的id-->
        <collection property="itemRelationId" ofType="wechat_business.entity.ItemRelation" column="ID">
            <id column="ID" property="id" jdbcType="BIGINT"/>
            <result column="SELLER_INFO_ID" property="sellerInfo" jdbcType="BIGINT"/>
            <result column="ITEM_INFO_ID" property="itemInfo" jdbcType="BIGINT"/>
            <result column="INVENTORY" property="inventory" jdbcType="DOUBLE"/>
            <result column="PRICE" property="price" jdbcType="DOUBLE"/>
        </collection>
    </resultMap>
    <!-- 根据id删除 -->
    <delete id="deleteById" parameterType="java.lang.Long">
        DELETE FROM ACTIVITY_RELATION WHERE ID=#{id}
    </delete>
    <!-- 根据多个id删除 -->
    <delete id="deleteByIds" parameterType="java.util.Arrays">
        DELETE FROM ACTIVITY_RELATION WHERE ID IN
        <foreach collection="array" item="ids" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>
    <!-- 保存 -->
    <insert id="save" parameterType="wechat_business.entity.ActivityRelation">
        INSERT INTO ACTIVITY_RELATION(ID,ITEM_RELATION_ID,ACTIVITY_INFO_ID) VALUES (#{id},#{itemRelationId},#{activityInfoId})
    </insert>
    <!-- 修改 -->
    <update id="update" parameterType="wechat_business.entity.ActivityRelation">
        UPDATE ACTIVITY_RELATION SET ITEM_RELATION_ID=#{itemRelationId},ACTIVITY_INFO_ID=#{activityInfoId} WHERE ID=#{id}
    </update>
    <!-- 根据id查询 -->
    <select id="findById" parameterType="java.lang.Long" resultMap="activityRelationMap">
        SELECT ID,ITEM_RELATION_ID,ACTIVITY_INFO_ID FROM ACTIVITY_RELATION WHERE ID=#{id}
    </select>
    <!-- 根据条件查询 -->
    <select id="findByCondtion" resultMap="activityRelationMap">
        SELECT ID,ITEM_RELATION_ID,ACTIVITY_INFO_ID FROM ACTIVITY_RELATION WHERE 1=1
        <if test="@Ognl@isNotEmpty(ITEM_RELATION_ID)">
            AND ITEM_RELATION_ID LIKE #{itemRelationId}
        </if>
        <if test="@Ognl@isNotEmpty(ACTIVITY_INFO_ID)">
            AND ACTIVITY_INFO_ID LIKE #{activityInfoId}
        </if>
    </select>
    <!-- 根据条件分页查询 -->
    <select id="findByCondtionForPage" resultMap="activityRelationMap">
        SELECT ID,ITEM_RELATION_ID,ACTIVITY_INFO_ID FROM ACTIVITY_RELATION WHERE 1=1
        <if test="@Ognl@isNotEmpty(ITEM_RELATION_ID)">
            AND ITEM_RELATION_ID LIKE #{itemRelationId}
        </if>
        <if test="@Ognl@isNotEmpty(ACTIVITY_INFO_ID)">
            AND ACTIVITY_INFO_ID LIKE #{activityInfoId}
        </if>
    </select>
</mapper>